from flask import Flask, request, jsonify

app = Flask(__name__)

# Store hooked browser data
hooked_browsers = []

@app.route('/')
def index():
    return "<h1>Ethical BeEF PoC</h1><p>Use the /hook endpoint to inject the JavaScript payload.</p>"

# Endpoint to receive browser data
@app.route('/hook', methods=['POST'])
def hook():
    data = request.json
    if data:
        hooked_browsers.append(data)
        return jsonify({"status": "success", "message": "Browser hooked"})
    return jsonify({"status": "error", "message": "No data received"})

# View all hooked browsers
@app.route('/browsers', methods=['GET'])
def list_browsers():
    return jsonify(hooked_browsers)

if __name__ == '__main__':
    app.run(debug=True, host='0.0.0.0', port=5000)
